<html>
<head>
	<meta http-equiv="X-UA-Compatible" content="IE=edge"/>
	<meta charset="utf-8"/>
	<title>bing search</title>
	<style type="text/css">
	body{background-color: #333;}
	.bg-div{position:relative;background-image: url(river.jpg);width:1228px;height:690px;margin: 0 auto;}
	.logo{background-image: url(logo.png);height:53px;width: 107px; float: left;margin: -4px 18px 0 0;}
	.search-form{float: left; background-color: #fff;padding:5px;}
	.search-text{height:25px;line-height: 25px;float: left;width: 350px;border: 0;outline: none;}
	.search-button{background-image: url(search-button.png);width:29px;height:29px;float: left;border: 0}
	.search-box{position:absolute;top:150px;left: 200px; }
	.suggest{width:388px; background-color:#fff;position:absolute;margin:0;padding:0;border-width:1px;border-style:solid;border-color: #999;}
	.suggest ul{list-style:none;display:block;margin:0;padding:0}
	.suggest ul li {padding:3px;line-height:25px;font-size: 14px;color: #777;cursor: pointer;padding:3px;}
	.suggest ul li:hover{background-color:#e5e5e5;text-decoration: underline;}
	.suggest strong{color:#000;}
	</style>
</head>

<body>
 <div class="bg-div">
 	<div class="search-box">
 	<div class="logo"></div>
 	
	 	<form id="search-form" class="search-form" action="https://cn.bing.com/search" target="_blank">
	 		<input type="text" class="search-text" name="q" id="search_input"/>
	 		<input type="submit" class="search-button" value=""/>
	 	</form>
 	</div>
 </div>
 <div class="suggest" id="search-suggest" style="display:none">
	 <ul id="search-result">
		 <li> 搜索内容 </li>
		 <li> 搜索内容 </li>
	 </ul>
 </div>
<script>
	var getElementTop = function(element){
		var actualTop = element.offsetTop;
		var parent = element.offsetParent;
		while(parent!=null){
			actualTop += parent.offsetTop;
			parent = parent.offsetParent;
		}
		return actualTop;
	};
	var getElementLeft = function(element){
		var actualLeft = element.offsetLeft;
		var parent = element.offsetParent;
		while(parent!=null){
			actualLeft += parent.offsetLeft;
			parent = parent.offsetParent;
		}
		return actualLeft;
	};
	//addEventListener适用于非IE浏览器
	//attachEvent适用于IE浏览器
	var inputTxt = document.getElementById("search_input");
	if(inputTxt.addEventListener){
		inputTxt.addEventListener('keyup',function(){
			var request;
			if(window.XMLHttpRequest){
				request=new window.XMLHttpRequest();
			}else{
				request=new ActiveXObject("Microsoft.XMLHttp");
			}
			var inputKey = inputTxt.value;
			request.open("GET","http://api.bing.com/qsonhs.aspx?q="+inputKey,true);
			request.send();
			request.onreadystatechange = function(){
				/*0 未初始化，还没有调用open()方法
				 * 1 载入，已调用send()方法，正在发送请求
				 * 2 载入完成，send()方法完成，已收到全部响应内容
				 * 3 解析，正在解析响应内容
				 * 4 完成，响应内容解析完成，可以在客户端调用了*/
				//oAjax.readyState 浏览器和服务器，进行到哪一步了
				if(request.readyState==4){
					if(request.status==200){
						var msg = JSON.parse(request.responseText);
						msg = msg.AS.Results[0].Suggests;
						var htmlTxt = '';
						for(var i=0; i<msg.length; i++){
							htmlTxt += '<li>'+msg[i].Txt+'</li>';
						}
						document.getElementById("search-suggest").style.display="block";
						document.getElementById("search-suggest").innerHTML=htmlTxt;
					}
					else {
						alert('失败'+request.status);
					}
				}
			};
			document.getElementById("search-suggest").style.top = getElementTop(document.getElementById("search-form")) + document.getElementById("search-form").offsetHeight;
			document.getElementById("search-suggest").style.left = getElementLeft(document.getElementById("search-form"));
		},false);
	}
	else if(inputTxt.attachEvent){
		inputTxt.attachEvent('onkeyup',function(){
			var request;
			if(window.XMLHttpRequest){
				request=new window.XMLHttpRequest();
			}else{
				request=new ActiveXObject("Microsoft.XMLHttp");
			}
			var inputKey = inputTxt.value;

			request.open("GET","http://api.bing.com/qsonhs.aspx?q="+inputKey,true);
			request.send();
			request.onreadystatechange = function(){
				/*0 未初始化，还没有调用open()方法
				 * 1 载入，已调用send()方法，正在发送请求
				 * 2 载入完成，send()方法完成，已收到全部响应内容
				 * 3 解析，正在解析响应内容
				 * 4 完成，响应内容解析完成，可以在客户端调用了*/
				//oAjax.readyState 浏览器和服务器，进行到哪一步了
				if(request.readyState==4){
					if(request.status==200){
						var msg = JSON.parse(request.responseText);
						msg = msg.AS.Results[0].Suggests;
						var htmlTxt = '';
						for(var i=0; i<msg.length; i++){
							htmlTxt += '<li>'+msg[i].Txt+'</li>';
						}
						document.getElementById("search-suggest").style.display="block";
						document.getElementById("search-suggest").innerHTML=htmlTxt;
					}
					else {
						alert('失败'+request.status);
					}
				}
			};
		});
	}
</script>
</body>
</html>
